# Strategy

## Стратегия

**Паттерн Стратегия (Strategy)** — это поведенческий паттерн проектирования, который определяет семейство алгоритмов,
инкапсулирует каждый из них и делает их взаимозаменяемыми. Стратегия позволяет изменять алгоритмы независимо от
клиентов, которые ими пользуются.

#### Основная идея

Паттерн Стратегия позволяет определить набор взаимозаменяемых алгоритмов, помещая их в отдельные классы, и делать их
взаимозаменяемыми во время выполнения программы. Это достигается путем использования интерфейса или абстрактного класса,
который определяет общий метод для всех алгоритмов.

#### Применение

Паттерн Стратегия рекомендуется использовать в следующих случаях:

- Необходимо выбрать один из нескольких алгоритмов в зависимости от условий во время выполнения.
- Алгоритмы часто изменяются или расширяются.
- Необходимо избежать множественных условных операторов (```if```, ```switch```) для выбора алгоритма.
- Хотите обеспечить повторное использование алгоритмов независимо от контекста.

### Реализация

1. Определите алгоритм, который подвержен частым изменениям. Также подойдёт алгоритм, имеющий несколько вариаций,
   которые выбираются во время выполнения программы.
2. Создайте интерфейс стратегий, описывающий этот алгоритм. Он должен быть общим для всех вариантов алгоритма.
3. Поместите вариации алгоритма в собственные классы, которые реализуют этот интерфейс.
4. В классе контекста создайте поле для хранения ссылки на текущий объект-стратегию, а также метод для её изменения.
   Убедитесь в том, что контекст работает с этим объектом только через общий интерфейс стратегий.
5. Клиенты контекста должны подавать в него соответствующий объект-стратегию, когда хотят, чтобы контекст вёл себя
   определённым образом.

### Примеры

#### Примеры из стандартной библиотеки Java

- Интерфейс ```Comparator``` в пакете ```java.util``` является классическим примером паттерна Стратегия. Он позволяет
  определить различные стратегии сравнения объектов при сортировке коллекций.

#### [Пример](code%2Fexample2_sort%2FMain.java) разных стратегий сортировки списка

Создадим простую систему сортировки списка строк с возможностью выбора различных стратегий сортировки. Например, по
возрастанию, по убыванию, по длине. Обратите внимание что сортировка по возрастанию и по убыванию проводится в
лексикографическом порядке.

---

Интерфейс ```SortStrategy``` - Определяет общий метод ```sort``` для всех стратегий сортировки.

```java
public interface SortStrategy {
    void sort(List<String> items);
}
```

---

```AscendingSort``` - конкретная реализация - сортировка по возрастанию.

```java
public class AscendingSort implements SortStrategy {
    @Override
    public void sort(List<String> items) {
        Collections.sort(items);
        System.out.println("Сортировка по возрастанию: " + items);
    }
}
```

---

```DescendingSort``` - конкретная реализация - сортировка по убыванию.

```java
public class DescendingSort implements SortStrategy {
    @Override
    public void sort(List<String> items) {
        Collections.sort(items, Comparator.reverseOrder());
        System.out.println("Сортировка по убыванию: " + items);
    }
}
```

---

```LengthSort``` - конкретная реализация - сортивка по длине.

```java
public class LengthSort implements SortStrategy {
    @Override
    public void sort(List<String> items) {
        items.sort(Comparator.comparingInt(String::length));
        System.out.println("Сортировка по длине: " + items);
    }
}
```

---

```Sorter``` - класс исполняющий стратегию, содержит внутри ссылку на стретегию.

```java
public class Sorter {
    private SortStrategy strategy;

    public void setStrategy(SortStrategy strategy) {
        this.strategy = strategy;
    }

    public void sort(List<String> items) {
        if (Objects.isNull(strategy)) throw new IllegalStateException("SortStrategy не установлена.");
        strategy.sort(items);
    }
}
```

---

```java
public class Main {
    public static void main(String[] args) {
        Sorter sorter = new Sorter();
        List<String> items = Stream.of("яблоко", "банан", "киви", "апельсин", "груша")
                .collect(Collectors.toList());

        // Сортировка по возрастанию (лексикограф. порядок)
        sorter.setStrategy(new AscendingSort());
        sorter.sort(items);

        // Сортировка по убыванию (лексикограф. порядок)
        sorter.setStrategy(new DescendingSort());
        sorter.sort(items);

        // Сортировка по длине
        sorter.setStrategy(new LengthSort());
        sorter.sort(items);
    }
}
```

### Плюсы данного паттерна

- **Гибкость:** Позволяет легко изменять поведение объекта путем замены используемой стратегии.
- **Расширяемость:** Легко добавлять новые стратегии без изменения существующего кода.
- **Снижение связанности:** Контекст и стратегии слабо связаны, что облегчает поддержку и расширение системы.
- **Повторное использование:** Одна и та же стратегия может использоваться в разных контекстах.

### Недостатки данного паттерна

- **Увеличение числа классов:** Каждая новая стратегия требует создания отдельного класса, что может привести к
  увеличению количества классов в проекте.
- **Сложность управления стратегиями:** Необходимо обеспечить правильное управление и выбор стратегий, особенно если их
  много.
- **Потенциальные проблемы с производительностью:** Создание большого числа объектов-стратегий может привести к
  увеличению потребления памяти.

### Сравнение с другими паттернами

Паттерны **Состояние** и **Стратегия** похоже, а их UML-диаграммы по сути одинаковы.

Паттерн **Стратегия** инкапсулирует алгоритмы. Поведение объекта реализуется
различными способами: Существует множество алгоритмов для сжатия, шифрования или сортировки данных. Но
вам понадобится только один алгоритм. Поэтому из множества стратегий выберите ту.
ту, которая решает вашу задачу наиболее эффективно.

Паттерн **Состояние** используется для инкапсуляции характеристик состояния. Поведение объекта
зависит от его состояния. Когда объект находится в определенном состоянии, он ведет себя иначе, чем
когда он находится в другом состоянии.

### Заключение

**Паттерн Стратегия (Strategy)** является мощным инструментом для управления поведением объектов и выбора алгоритмов во
время выполнения программы. Он обеспечивает гибкость, расширяемость и снижает связанность между компонентами системы.

Однако, при использовании паттерна Стратегия важно учитывать его преимущества и недостатки, чтобы не создавать
избыточную структуру классов в простых системах.

### Источники

- Design Patterns with Java: Strategy
- Введение в паттерны проектирования: Стратегия